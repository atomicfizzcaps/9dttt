# ğŸš€ Split Deployment Guide

## Backend on Render + Frontend on Vercel

This guide explains how to deploy your application with the backend on Render and frontend on Vercel.

---

## ğŸ“‹ Architecture

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   VERCEL        â”‚         â”‚    RENDER       â”‚
â”‚   (Frontend)    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   (Backend)     â”‚
â”‚                 â”‚  API    â”‚                 â”‚
â”‚ - HTML/CSS/JS   â”‚  Calls  â”‚ - Node.js       â”‚
â”‚ - Static Files  â”‚         â”‚ - WebSockets    â”‚
â”‚ - Assets        â”‚         â”‚ - Database      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     d9ttt.com          ninedttt.onrender.com
```

---

## ğŸ”§ Step 1: Deploy Backend to Render

### A. Create Render Account

1. Go to [render.com](https://render.com)
2. Sign up with GitHub
3. Connect your repository

### B. Create Web Service

1. Click "New +" â†’ "Web Service"
2. Select your `9dttt` repository
3. Configure:

   ```text
   Name: 9dttt-backend
   Region: Oregon (US West)
   Branch: main
   Runtime: Node
   Build Command: npm install
   Start Command: node server.js
   Plan: Free
   ```

### C. Set Environment Variables

Add these in Render Dashboard â†’ Environment:

**Required:**

- `NODE_ENV` = `production`
- `PORT` = `10000`
- `FRONTEND_URL` = `https://d9ttt.com` (your Vercel domain)
- `JWT_SECRET` = (auto-generated by Render)

**Optional:**

- `FIREBASE_API_KEY` = (your Firebase key)
- `FIREBASE_AUTH_DOMAIN` = (your Firebase domain)
- `FIREBASE_PROJECT_ID` = (your Firebase project)
- `REDIS_URL` = (if using Redis)

### D. Deploy

1. Click "Create Web Service"
2. Wait for deployment (~2-3 minutes)
3. Copy your backend URL: `https://ninedttt.onrender.com`

---

## ğŸ¨ Step 2: Deploy Frontend to Vercel

### A. Update vercel.json

Already configured! The file now:

- Serves only static files from `Public/`
- Proxies `/api/*` requests to Render backend
- Proxies `/socket.io/*` to Render for WebSockets

### B. Deploy to Vercel

#### Option 1: Vercel CLI (Recommended)

```bash
# Install Vercel CLI
npm install -g vercel

# Login
vercel login

# Deploy
vercel --prod
```

#### Option 2: Vercel Dashboard

1. Go to [vercel.com](https://vercel.com)
2. Sign up with GitHub
3. Import your `9dttt` repository
4. Configure:

   ```text
   Framework Preset: Other
   Build Command: (leave empty)
   Output Directory: Public
   Install Command: (leave empty)
   ```

5. Click "Deploy"

### C. Set Custom Domain (Optional)

1. In Vercel Dashboard â†’ Settings â†’ Domains
2. Add `d9ttt.com` and `www.d9ttt.com`
3. Update DNS records as shown

---

## ğŸ”— Step 3: Connect Frontend to Backend

### Update Backend URL in render.yaml

```yaml
envVars:
  - key: FRONTEND_URL
    value: https://your-vercel-app.vercel.app  # Update with actual Vercel URL
```

### Update Frontend to Use Correct Backend

The `vercel.json` rewrites automatically proxy API calls to Render:

- Frontend: `https://d9ttt.com/api/health`
- Backend: `https://ninedttt.onrender.com/api/health`

No code changes needed! âœ¨

---

## âœ… Step 4: Verify Deployment

### Test Backend

```bash
curl https://ninedttt.onrender.com/api/health
```

Expected: `{"status":"ok","uptime":...}`

### Test Frontend

```bash
curl https://d9ttt.com
```

Expected: HTML content

### Test API Proxy

```bash
curl https://d9ttt.com/api/health
```

Expected: Same as backend health check

---

## ğŸ”„ Automatic Deployments

Both services auto-deploy on `git push`:

### Backend (Render)

```bash
git add .
git commit -m "Update backend"
git push origin main
# Render automatically deploys
```

### Frontend (Vercel)

```bash
git add Public/
git commit -m "Update frontend"
git push origin main
# Vercel automatically deploys
```

---

## ğŸ’¡ Benefits of Split Deployment

âœ… **Performance**: Static files served by Vercel's edge CDN (faster)  
âœ… **Scalability**: Backend can scale independently  
âœ… **Cost**: Frontend is free on Vercel, backend free tier on Render  
âœ… **Reliability**: If one service is down, the other still works  
âœ… **Development**: Deploy frontend/backend separately  

---

## ğŸ› Troubleshooting

### CORS Errors

**Problem**: API calls blocked by browser  
**Solution**: Verify `FRONTEND_URL` is correct in Render environment variables

### WebSocket Connection Failed

**Problem**: Socket.io can't connect  
**Solution**: Check that `vercel.json` rewrites `/socket.io/*` correctly

### 404 on API Calls

**Problem**: `/api/*` returns 404  
**Solution**: Ensure backend is running on Render and URL is correct in `vercel.json`

### Render Service Sleeping

**Problem**: First request is slow (free tier)  
**Solution**: Keep-alive is configured in `server.js` to ping every 14 minutes

---

## ğŸ“Š Monitoring

### Backend Health

```bash
# Check backend status
curl https://ninedttt.onrender.com/api/health

# View Render logs
render logs -f
```

### Frontend Status

```bash
# Check Vercel deployment
vercel ls

# View deployment logs
vercel logs
```

---

## ğŸ” Security Checklist

- [x] HTTPS enabled on both services
- [x] CORS configured for your domains only
- [x] API rate limiting enabled
- [x] JWT secrets auto-generated
- [x] Environment variables not in code
- [x] Security headers configured

---

## ğŸ“š Next Steps

1. Set up custom domain on Vercel
2. Configure Firebase for social login
3. Add Redis for session persistence
4. Set up monitoring/alerts
5. Configure backup strategy

---

## ğŸ†˜ Need Help?

- [Render Documentation](https://render.com/docs)
- [Vercel Documentation](https://vercel.com/docs)
- [Socket.io CORS Guide](https://socket.io/docs/v4/handling-cors/)

---

## ğŸ‰ You're Done

Your app is now running:

- **Frontend**: <https://d9ttt.com> (Vercel)
- **Backend**: <https://ninedttt.onrender.com> (Render)

Both will auto-deploy on every push to `main`!
