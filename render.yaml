# Render Blueprint - 9DTTT Backend API & WebSocket Server
# Backend-only deployment - Frontend served by Vercel

services:
  - type: web
    name: 9dttt-backend
    runtime: node
    region: oregon
    plan: free
    branch: main
    buildCommand: npm install
    startCommand: node server.js
    
    healthCheckPath: /api/health
    
    envVars:
      - key: NODE_ENV
        value: production
      
      - key: PORT
        value: 10000
      
      # Frontend URL for CORS
      - key: FRONTEND_URL
        value: https://9dttt.vercel.app
      
      - key: VERCEL_URL
        value: https://your-vercel-app.vercel.app
      
      # JWT Secret - auto-generated secure random string
      - key: JWT_SECRET
        generateValue: true
      
      # Backend self-URL (set after first deploy)
      - key: BACKEND_URL
        value: https://ninedttt.onrender.com
      
      # Keep-alive configuration
      - key: RENDER_EXTERNAL_URL
        sync: false
      
      # Redis (optional - for session persistence)
      - key: REDIS_URL
        sync: false
      
      # Firebase (optional - for Google/Apple sign-in)
      - key: FIREBASE_API_KEY
        sync: false
      - key: FIREBASE_AUTH_DOMAIN
        sync: false
      - key: FIREBASE_PROJECT_ID
        sync: false
      - key: FIREBASE_STORAGE_BUCKET
        sync: false
      - key: FIREBASE_MESSAGING_SENDER_ID
        sync: false
      - key: FIREBASE_APP_ID
        sync: false
      
      # Database (optional - PostgreSQL for persistence)
      - key: DATABASE_URL
        sync: false
      
      # Rate limiting
      - key: RATE_LIMIT_ENABLED
        value: "true"
      
      # Security
      - key: ENABLE_HTTPS_REDIRECT
        value: "false"
      
    # Health checks
    autoDeploy: true
